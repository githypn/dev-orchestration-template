# A2A プロトコル移行ロードマップ

<!-- =======================================================================
  このファイルは汎用テンプレートである。
  プロジェクトが A2A 移行を計画する際に、コピーして記入・カスタマイズすること。
  {{}} で囲まれた箇所をプロジェクト固有の情報に置き換えること。
  CUSTOMIZE コメントのあるセクションは、プロジェクトの実情に合わせて加筆・修正すること。
======================================================================= -->

## プロジェクト情報

- プロジェクト名: {{プロジェクト名}}
- 現在のエージェント間通信方式: {{例: GitHub Copilot Agent 内部委譲 / LangGraph / CrewAI 等}}
- 作成日: {{日付}}
- 最終更新日: {{日付}}

---

## 1. 移行の判断基準

以下の条件が 1 つ以上満たされた場合に A2A 移行を検討すること。

- [ ] 異なるベンダーのエージェントフレームワークと連携する必要が生じた
- [ ] エージェントを外部の別チームや別システムに公開する必要が生じた
- [ ] エージェントの能力を動的に発見・選択する仕組みが必要になった
- [ ] 現在の通信方式がスケーラビリティの制約に達した
<!-- CUSTOMIZE: プロジェクト固有の条件を追記すること -->

---

## 2. 現状と目標の差分分析

<!-- CUSTOMIZE: プロジェクトの現状に合わせて記入すること -->

| 観点 | 現在の方式 | A2A 方式 |
|------|-----------|---------|
| 通信方式 | {{現在の方式}} | HTTP / SSE / JSON-RPC / gRPC |
| エージェント発見 | {{現在の方式}} | Agent Card (`/.well-known/agent.json`) |
| 認証 | {{現在の方式}} | Bearer Token / Signed Agent Card |
| データ形式 | {{現在の方式}} | A2A Message / Part / Artifact（構造化） |
| ストリーミング | {{現在の方式}} | SSE / gRPC stream |

---

## 3. 段階的移行の手順案

<!-- CUSTOMIZE: プロジェクトの実情に合わせて加筆・修正すること -->

### フェーズ 1: Agent Card の設計（コード変更なし）

- [ ] 各エージェントの Agent Card を `docs/a2a-design/` に作成する
  - テンプレート: [agent-card-template.json](agent-card-template.json)
  - 設計ガイド: [README.md](README.md)
- [ ] エンドポイント URL 設計を決定する
- [ ] 認証方式を決定する
- [ ] スキル定義のレビューを実施する

### フェーズ 2: A2A サーバーの実験的実装（本番稼働しない）

- [ ] 既存システムと並行して動作する A2A サーバーを実装する
- [ ] 既存の委譲フローを A2A メッセージに変換するアダプター層を作成する
- [ ] Agent Card を `/.well-known/agent.json` で公開する
- [ ] テスト環境で A2A クライアントからの呼び出しを検証する

### フェーズ 3: 段階的切り替え

- [ ] テスト環境で A2A による委譲に切り替える
- [ ] 既存方式と A2A 方式のデュアルラン期間を設ける
- [ ] 本番環境へ段階的に展開する
- [ ] 既存方式の廃止スケジュールを決定する

---

## 4. リスクと対応策

<!-- CUSTOMIZE: プロジェクト固有のリスクを追記すること -->

| リスク | 影響度 | 対応策 |
|--------|--------|--------|
| A2A 仕様の破壊的変更 | 中 | アダプター層で吸収する。v0.3 安定版に準拠する |
| エージェント間通信のセキュリティ（ASI07） | 高 | 認証・暗号化を必須とする。Signed Agent Card を採用する |
| 移行期間中のデュアルラン運用負荷 | 中 | フェーズ 3 の期間を限定し、早期に旧方式を廃止する |
| {{リスク}} | 高/中/低 | {{対応策}} |

---

## 5. 完了条件

- [ ] すべてのエージェントが A2A Agent Card を公開している
- [ ] A2A タスク API でエージェント間通信が動作している
- [ ] セキュリティ要件（認証・暗号化）が満たされている
- [ ] 旧通信方式が廃止されている
- [ ] 移行完了の ADR が記録されている
